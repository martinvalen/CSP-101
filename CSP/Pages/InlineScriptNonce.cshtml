@page
@model InlineScriptNonceModel

@{
    Layout = "Shared/_CspLayout";
}


@section Explanation
{
    <pre>
&lt;script nonce="@Model.ScriptNonce"&gt;
    changeColorToRed();
&lt;/script&gt;
</pre>

    <pre>
model.ScriptNonce = GetUniqueKey(100);

private static string GetUniqueKey(int size)
{
    var chars =
        "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".ToCharArray();
    var data = new byte[size];
    using (var crypto = new RNGCryptoServiceProvider())
    {
        crypto.GetBytes(data);
    }
    var result = new StringBuilder(size);
    foreach (var b in data)
    {
        result.Append(chars[b % (chars.Length)]);
    }
    return result.ToString();
}
</pre>
}

@section ScriptSection
{
    <script>alert("Someone managed to sneak malicious code into the page through an inline script!");</script>

    <script nonce="@Model.ScriptNonce">
        window.onload = function (e) {
            document.getElementById("should-be-red").style.backgroundColor = "red";
        };
    </script>
}